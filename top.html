<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–æ–¥—Å—á–µ—Ç –ó–ü</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            transition: background-color 0.5s;
        }
        #menu {
            display: none;
            position: absolute;
            top: 50px;
            right: 10px;
            background: #fff;
            border: 1px solid #ccc;
            padding: 10px;
        }
        .news, .moderator, .salary-output {
            margin: 20px;
        }
        button {
            margin: 5px;
        }
        .salary-output {
            margin-top: 10px;
            padding: 10px;
            border: 1px solid #ccc;
            background: #f9f9f9;
        }
        textarea {
            width: 100%;
            height: 300px;
            margin-top: 10px;
        }
        .moderator-entry {
            padding: 10px;
            border: 1px solid #ccc;
            background: #e9f7ef;
            margin-bottom: 10px;
        }
        .warning {
            color: red;
            font-weight: bold;
        }
        .bonus {
            color: green;
            font-weight: bold;
        }
    </style>
</head>
<body>

<h1>–ù–æ–≤–æ—Å—Ç–∏ –ø–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º —Å–∞–π—Ç–∞</h1>
<button id="menuButton">–ú–µ–Ω—é</button>
<button id="bgButton">–°–º–µ–Ω–∏—Ç—å —Ü–≤–µ—Ç —Ñ–æ–Ω–∞</button>
<div id="menu">
    <button id="settingsButton">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
    <button id="countButton">–ü–æ–¥—Å—á–µ—Ç</button>
    <button id="accountButton">–°–æ–∑–¥–∞—Ç—å –∏–ª–∏ –≤–æ–π—Ç–∏ –≤ –∞–∫–∫–∞—É–Ω—Ç</button>
    <button id="logoutButton" style="display: none;">–í—ã–π—Ç–∏</button>
</div>

<div class="news" id="newsContainer">
    <h2>–ù–æ–≤–æ—Å—Ç–∏</h2>
    <button id="createNewsButton">–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ—Å—Ç—å</button>
    <div id="newsList"></div>
</div>

<h1>–ü–æ–¥—Å—á–µ—Ç –∑–∞—Ä–ø–ª–∞—Ç—ã</h1>

<div class="moderator" id="moderatorContainer">
    <h2>–î–æ–±–∞–≤—å—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–∑ —Ñ–∞–π–ª–∞ data.txt</h2>
    <textarea id="moderatorInput" placeholder="–í—Å—Ç–∞–≤—å—Ç–µ —Ç–µ–∫—Å—Ç —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞—Ö –∑–¥–µ—Å—å..."></textarea>
    <button id="processModeratorsButton">–û–±—Ä–∞–±–æ—Ç–∞—Ç—å –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–æ–≤</button>
    <div id="moderatorList"></div>
</div>

<div class="salary-output" id="salaryOutput" style="display: none;"></div>

<script>
    let isLoggedIn = false;

    document.getElementById('menuButton').onclick = function() {
        const menu = document.getElementById('menu');
        menu.style.display = menu.style.display === 'none' ? 'block' : 'none';
        document.getElementById('logoutButton').style.display = isLoggedIn ? 'inline' : 'none';
        document.getElementById('accountButton').style.display = isLoggedIn ? 'none' : 'inline';
    };

    document.getElementById('bgButton').onclick = function() {
        document.body.style.backgroundColor = document.body.style.backgroundColor === 'lightblue' ? 'white' : 'lightblue';
    };

    document.getElementById('createNewsButton').onclick = function() {
        const newsText = prompt("–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –Ω–æ–≤–æ—Å—Ç–∏:");
        if (newsText) {
            const newsItem = document.createElement('div');
            newsItem.textContent = newsText;
            document.getElementById('newsList').appendChild(newsItem);
        }
    };

    document.getElementById('processModeratorsButton').onclick = function() {
        const inputText = document.getElementById('moderatorInput').value.trim();
        const moderatorListDiv = document.getElementById('moderatorList');
        moderatorListDiv.innerHTML = ''; // –û—á–∏—Å—Ç–∏—Ç—å –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ

        const lines = inputText.split('\n');
        let moderatorEntries = [];
        let maxActions = 0;

        for (let i = 0; i < lines.length; i++) {
            const line = lines[i].trim();
            if (line.startsWith("–ù–∏–∫-–Ω–µ–π–º –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞:")) {
                const nickname = line.split(":")[1].trim();
                const vkLine = lines[++i].trim();
                const positionLine = lines[++i].trim();
                const discordIdLine = lines[++i].trim();
                const actionsLine = lines[++i].trim();

                const actionsMatch = actionsLine.match(/(\d+) \(([\d.]+)%\)/);
                if (actionsMatch) {
                    const actionsCount = parseInt(actionsMatch[1]);
                    let pearls = 0;
                    let bonuses = 0;
                    let position = positionLine.split(":")[1].trim();

                    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∂–µ–º—á—É–∂–∏–Ω—ã –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —É—Ä–æ–≤–Ω—è
                    switch (position) {
                        case "–ú–ª–∞–¥—à–∏–π –º–æ–¥–µ—Ä–∞—Ç–æ—Ä":
                            pearls = 45;
                            if (actionsCount > 15) {
                                bonuses += Math.floor((actionsCount - 15) / 5) * 5;
                            }
                            break;
                        case "–ú–æ–¥–µ—Ä–∞—Ç–æ—Ä":
                            pearls = 40;
                            if (actionsCount > 12) {
                                bonuses += Math.floor((actionsCount - 12) / 5) * 5;
                            }
                            break;
                        case "–°—Ç–∞—Ä—à–∏–π –º–æ–¥–µ—Ä–∞—Ç–æ—Ä":
                            pearls = 40;
                            if (actionsCount > 10) {
                                bonuses += Math.floor((actionsCount - 10) / 5) * 5;
                            }
                            break;
                        case "–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –º–æ–¥–µ—Ä–∞—Ç–æ—Ä":
                            pearls = 35;
                            if (actionsCount > 5) {
                                bonuses += Math.floor((actionsCount - 5) / 5) * 5;
                            }
                            break;
                        default:
                            continue; // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º, –µ—Å–ª–∏ —É—Ä–æ–≤–µ–Ω—å –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç
                    }

                    // –†–∞—Å—á–µ—Ç –±–æ–Ω—É—Å–æ–≤ –∑–∞ —Ä–µ–ø—É—Ç–∞—Ü–∏—é
                    const reputation = Math.floor(actionsCount / 5);
                    if (reputation >= 20) {
                        bonuses += Math.floor((reputation - 20) / 5) * 5 + 5; // –ë–æ–Ω—É—Å—ã –∑–∞ —Ä–µ–ø—É—Ç–∞—Ü–∏—é
                    }

                    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ–π—Å—Ç–≤–∏–π
                    if (actionsCount > maxActions) {
                        maxActions = actionsCount;
                    }

                    moderatorEntries.push({
                        nickname: nickname,
                        vk: vkLine.split(":")[1].trim(),
                        position: position,
                        discordId: discordIdLine.split(":")[1].trim(),
                        actionsCount: actionsCount,
                        actionsMatch: actionsMatch[2],
                        pearls: pearls,
                        bonuses: bonuses,
                        warning: false
                    });
                }
            }
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–≤–æ–¥–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞—Ö
        moderatorEntries.forEach(entry => {
            let output = `<div class="moderator-entry">
                üöπ | ${entry.nickname}<br>
                üìî | –í–∫–æ–Ω—Ç–∞–∫—Ç–µ: ${entry.vk}<br>
                üìã | ${entry.position}<br>
                üí¨ | –î–∏—Å–∫–æ—Ä–¥-–∞–π–¥–∏: ${entry.discordId}<br>
                üçÄ | –î–µ–π—Å—Ç–≤–∏–π (–æ–±—â–µ–µ –∫–æ–ª-–≤–æ): ${entry.actionsCount} (${entry.actionsMatch})<br>
                üíé | –ñ–µ–º—á—É–∂–∏–Ω—ã: ${entry.pearls}<br>
                üéÅ | –ë–æ–Ω—É—Å—ã: ${entry.bonuses}<br>`;

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω–µ–≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–æ—Ä–º—ã
            if ((entry.position === "–ú–ª–∞–¥—à–∏–π –º–æ–¥–µ—Ä–∞—Ç–æ—Ä" && entry.actionsCount < 15) ||
                (entry.position === "–ú–æ–¥–µ—Ä–∞—Ç–æ—Ä" && entry.actionsCount < 12) ||
                (entry.position === "–°—Ç–∞—Ä—à–∏–π –º–æ–¥–µ—Ä–∞—Ç–æ—Ä" && entry.actionsCount < 10) ||
                (entry.position === "–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –º–æ–¥–µ—Ä–∞—Ç–æ—Ä" && entry.actionsCount < 5)) {
                entry.warning = true;
                output += `<span class="warning">${entry.nickname} –ø–æ–ª—É—á–∞–µ—Ç –≤—ã–≥–æ–≤–æ—Ä - –Ω–µ–≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ–π –Ω–æ—Ä–º—ã.</span><br>`;
            }

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ–π—Å—Ç–≤–∏–π
            if (entry.actionsCount === maxActions) {
                entry.pearls += 30;
                entry.bonuses += 30;
                output += `<span class="bonus">${entry.nickname} –ø–æ–ª—É—á–∞–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ +30 –±–æ–Ω—É—Å–æ–≤ –∏ +30 –∂–µ–º—á—É–∂–∏–Ω!</span><br>`;
            }

            output += `</div>`;
            moderatorListDiv.innerHTML += output;
        });
    };

    document.getElementById('accountButton').onclick = function() {
        isLoggedIn = true;
        alert("–í—ã –≤–æ—à–ª–∏ –≤ –∞–∫–∫–∞—É–Ω—Ç!");
    };

    document.getElementById('logoutButton').onclick = function() {
        isLoggedIn = false;
        alert("–í—ã –≤—ã—à–ª–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞!");
    };
</script>

</body>
</html>

–ù–∞–π—Ç–∏ –µ—â–µ
